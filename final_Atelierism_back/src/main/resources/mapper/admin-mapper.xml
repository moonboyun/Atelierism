<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="kr.co.iei.admin.model.dao.AdminDao">
	<select id="priceListSelect" resultType="priceList">
		select * from price_tbl
	</select>
	
	<update id="updatePriceList">
		update price_tbl
			<set>
				<if test="priceLiving != null and priceLiving != 0">
            		price_living = #{priceLiving},
        		</if>
        		<if test="priceKitchen != null and priceKitchen != 0">
            		price_kitchen = #{priceKitchen},
        		</if>
        		<if test="priceBed != null and priceBed != 0">
            		price_bed = #{priceBed},
        		</if>
        		<if test="priceOneroom != null and priceOneroom != 0">
            		price_oneroom = #{priceOneroom},
        		</if>
        		<if test="priceKidroom != null and priceKidroom != 0">
            		price_kidroom = #{priceKidroom},
        		</if>
        		<if test="priceStudy != null and priceStudy != 0">
            		price_study = #{priceStudy},
        		</if>
        		<if test="priceCharge != null and priceCharge != 0">
            		price_charge = #{priceCharge},
        		</if>
			</set>
	</update>
	
	<select id="adminMemberList" resultType="member">
		select * from member_tbl where member_type = 3
	</select>
	
	<!-- <select id="adminDesignerList">
		
	</select> -->
	
	<select id="memberTotalCount" resultType="int">
		select count(*) from member_tbl where member_type = 3
	</select>
	
	<select id="applicantTotalCount" resultType="int">
		select count(*) from member_tbl m left join designer_tbl d on
		m.member_id = d.member_id
		<if test="memOrder == 'a1'">
			where m.member_type = 3 and m.designer_enter = 0 
			and d.designer_career is not null
		</if>
		<if test="memOrder == 'a2'">
			where m.member_type = 2 and m.designer_enter = 1 
			and d.designer_career is not null
		</if>
		<if test="memOrder == 'a3'">
			where m.member_type = 3 and m.designer_enter = 2 
			and d.designer_career is not null
		</if>
	</select>
	
	<select id="selectMemberList" resultType="member">
    SELECT * FROM (
        SELECT rownum AS rnum, b.*
        FROM (
            SELECT
                member_id,
                member_name,
                member_phone,
                member_type
            FROM member_tbl 
            WHERE member_type = 3
            
            <if test="memOrder == 'm1'">
                ORDER BY enroll_date DESC
            </if>
            <if test="memOrder == 'm2'">
                ORDER BY enroll_date ASC
            </if>
            ) b
    )
    WHERE rnum BETWEEN #{start} AND #{end}
</select>

<select id="selectApplicantList" resultType="applicant">
	SELECT * FROM (
        SELECT rownum AS rnum, b.*
        FROM (
            select m. designer_enter, m.member_phone, m.member_name, d.DESIGNER_CAREER , m.member_id
		from member_tbl m left join designer_tbl d on
		m.member_id = d.member_id
		<if test="memOrder == 'a1'">
			where m.designer_enter = 0 and m.member_type = 3 and d.designer_career is not null
			ORDER BY member_name DESC
		</if>
		<if test="memOrder == 'a3'">
			where m.designer_enter = 2 ORDER BY member_name DESC
		</if>
		<if test="memOrder == 'a2'">
			where m.designer_enter = 1 ORDER BY member_name DESC
		</if>
            ) b
    )
    WHERE rnum BETWEEN #{start} AND #{end}
</select>
</mapper>
