<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="kr.co.iei.interior.model.dao.InteriorDao">
  <insert id="insertInterior">
  	insert into interior_tbl values(
  		interior_seq.nextval,
  		#{interiorDesigner},
  		#{interiorCustomer},
  		#{interiorLiving},
  		#{interiorKitchen},
  		#{interiorBed},
  		#{interiorOneroom},
  		#{interiorKidroom},
  		#{interiorStudy},
  		#{interiorRange},
  		#{interiorWhy},
  		#{interiorPrice},
  		0,
  		null,
  		null
  	)
  </insert>
  <select id="selectIsInterior" resultType="int">
  	select count(*) from interior_tbl where interior_customer = #{memberId} and interior_payment_check = 0
  </select>
  <select id="selectInterior" resultType="interior">
  	select * from interior_tbl where interior_customer = #{memberId} and interior_payment_check = 0
  </select>
  <delete id="deleteInterior">
  	delete from interior_tbl where interior_no = #{interiorNo}
  </delete>

  <update id="updateInterior">
  	update interior_tbl set 
  		interior_designer = #{interiorDesigner},
  		interior_living = #{interiorLiving},
  		interior_kitchen = #{interiorKitchen},
  		interior_bed = #{interiorBed},
  		interior_oneroom = #{interiorOneroom},
  		interior_kidroom = #{interiorKidroom},
  		interior_study = #{interiorStudy},
  		interior_range = #{interiorRange},
  		interior_why = #{interiorWhy},
  		interior_price = #{interiorPrice}
  	where interior_no = #{interiorNo}
  </update>

  <select id="selectPaymentsByMemberId" resultType="interior">
  SELECT 
       i.INTERIOR_NO,
       i.INTERIOR_DESIGNER,
       i.INTERIOR_CUSTOMER,
       i.INTERIOR_LIVING,
       i.INTERIOR_KITCHEN,
       i.INTERIOR_BED,
       i.INTERIOR_ONEROOM,
       i.INTERIOR_KIDROOM,
       i.INTERIOR_STUDY,
       i.INTERIOR_RANGE,
       i.INTERIOR_WHY,
       i.INTERIOR_PRICE,
       i.INTERIOR_PAYMENT_DATE,
       d.DESIGNER_CHAT
  FROM INTERIOR_TBL i
  LEFT JOIN DESIGNER_TBL d
         ON i.INTERIOR_DESIGNER = d.MEMBER_ID
  WHERE i.INTERIOR_CUSTOMER = #{memberId}
    AND i.INTERIOR_PAYMENT_CHECK = 1
  <if test="sort == 'asc'">
    ORDER BY i.INTERIOR_PAYMENT_DATE ASC
  </if>
  <if test="sort == 'desc'">
    ORDER BY i.INTERIOR_PAYMENT_DATE DESC
  </if>
</select>
<update id="payUpdateInterior">
	update interior_tbl set 
		interior_payment_check=1, 
		interior_payment_date = to_char(sysdate,'yyyy-mm-dd'), 
		interior_payment_charge = #{interiorPaymentCharge}
	where interior_no = #{interiorNo}
</update>


</mapper>
